{
  "name": "Andfix",
  "tagline": "AndFix is a library that offer hot-fix for Android App.",
  "body": "# AndFix\r\n\r\n[![Download](https://api.bintray.com/packages/supern/maven/andfix/images/download.svg) ](https://bintray.com/supern/maven/andfix/_latestVersion)\r\n[![Build Status](https://travis-ci.org/alibaba/AndFix.svg)](https://travis-ci.org/alibaba/AndFix)\r\n[![Software License](https://rawgit.com/alibaba/AndFix/master/images/license.svg)](LICENSE)\r\n\r\n[![Gitter](https://badges.gitter.im/Join%20Chat.svg)](https://gitter.im/alibaba/AndFix?utm_source=badge&utm_medium=badge&utm_campaign=pr-badge)\r\n\r\nAndFix is a solution to fix the bugs online instead of redistributing Android App. It is distributed as [Android Library](https://sites.google.com/a/android.com/tools/tech-docs/new-build-system/aar-format).\r\n\r\nAndfix is an acronym for \"**And**roid hot-**fix**\".\r\n\r\nAndFix supports Android version from 2.3 to 7.0, both ARM and X86 architecture, both Dalvik and ART runtime, both 32bit and 64bit.\r\n\r\nThe compressed file format of AndFix's patch is **.apatch**. It is dispatched from your own server to client to fix your App's bugs.\r\n\r\n## Principle\r\n\r\nThe implementation principle of AndFix is method body's replacing,\r\n\r\n![image]( https://raw.githubusercontent.com/alibaba/AndFix/master/images/principle.png)\r\n\r\n### Method replacing\r\n\r\nAndFix judges the methods should be replaced by java custom annotation and replaces it by hooking it. AndFix has a native method `art_replaceMethod` in ART or `dalvik_replaceMethod` in Dalvik. \r\n\r\nFor more details, [here](https://github.com/alibaba/AndFix/tree/master/jni).\r\n\r\n## Fix Process\r\n\r\n![image](https://raw.githubusercontent.com/alibaba/AndFix/master/images/process.png)\r\n\r\n## Integration\r\n\r\n### How to get?\r\n\r\nDirectly add AndFix aar to your project as compile libraries.\r\n\r\nFor your maven dependency,\r\n\r\n```xml\r\n<dependency>\r\n  \t<groupId>com.alipay.euler</groupId>\r\n  \t<artifactId>andfix</artifactId>\r\n  \t<version>0.5.0</version>\r\n  \t<type>aar</type>\r\n</dependency>\r\n```\r\nFor your gradle dependency,\r\n\r\n```groovy\r\ndependencies {\r\n\tcompile 'com.alipay.euler:andfix:0.5.0@aar'\r\n}\r\n```\r\n\r\n### How to use?\r\n\r\n1. Initialize PatchManager,\r\n\r\n```java\r\npatchManager = new PatchManager(context);\r\npatchManager.init(appversion);//current version\r\n```\r\n\r\n2. Load patch,\r\n\r\n```java\r\npatchManager.loadPatch();\r\n```\r\n\r\nYou should load patch as early as possible, generally, in the initialization phase of your application(such as `Application.onCreate()`).\r\n\r\n3. Add patch,\r\n\r\n```java\r\npatchManager.addPatch(path);//path of the patch file that was downloaded\r\n```\r\nWhen a new patch file has been downloaded, it will become effective immediately by `addPatch`.\r\n\r\n## Developer Tool\r\n\r\nAndFix provides a patch-making tool called **apkpatch**.\r\n\r\n### How to get?\r\n\r\nThe `apkpatch` tool can be found [here](https://github.com/alibaba/AndFix/raw/master/tools/apkpatch-1.0.3.zip).\r\n\r\n### How to use?\r\n\r\n* Prepare two android packages, one is the online package, the other one is the package after you fix bugs by coding.\r\n\r\n* Generate `.apatch` file by providing the two package,\r\n\r\n```\r\nusage: apkpatch -f <new> -t <old> -o <output> -k <keystore> -p <***> -a <alias> -e <***>\r\n -a,--alias <alias>     keystore entry alias.\r\n -e,--epassword <***>   keystore entry password.\r\n -f,--from <loc>        new Apk file path.\r\n -k,--keystore <loc>    keystore path.\r\n -n,--name <name>       patch name.\r\n -o,--out <dir>         output dir.\r\n -p,--kpassword <***>   keystore password.\r\n -t,--to <loc>          old Apk file path.\r\n```\r\n\r\nNow you get the application savior, the patch file. Then you need to dispatch it to your client in some way, push or pull.\r\n\r\nSometimes, your team members may fix each other's bugs, and generate not only one `.apatch`. For this situation, you can\r\nmerge `.apatch` files using this tool,\r\n\r\n```\r\nusage: apkpatch -m <apatch_path...> -o <output> -k <keystore> -p <***> -a <alias> -e <***>\r\n -a,--alias <alias>     keystore entry alias.\r\n -e,--epassword <***>   keystore entry password.\r\n -k,--keystore <loc>    keystore path.\r\n -m,--merge <loc...>    path of .apatch files.\r\n -n,--name <name>       patch name.\r\n -o,--out <dir>         output dir.\r\n -p,--kpassword <***>   keystore password.\r\n```\r\n\r\n## Running sample\r\n\r\n1. Import samplesI/AndFixDemo to your IDE, append AndFixDemo dependencies with AndFix(library project or aar).\r\n2. Build project, save the package as 1.apk, and then install on device/emulator.\r\n3. Modify com.euler.test.A, references com.euler.test.Fix.\r\n4. Build project, save the package as 2.apk.\r\n5. Use apkpatch tool to make a patch.\r\n6. Rename the patch file to out.apatch, and then copy it to sdcard.\r\n7. Run 1.apk and view log.\r\n\r\n## Notice\r\n\r\n### ProGuard\r\n\r\nIf you enable ProGuard, you must save the mapping.txt, so your new version's build can use it with [\"-applymapping\"](http://proguard.sourceforge.net/manual/usage.html#applymapping).\r\n\r\nAnd it is necessary to keep classes as follow,\r\n\r\n* Native method\r\n\r\n\tcom.alipay.euler.andfix.AndFix\r\n\r\n* Annotation\r\n\r\n\tcom.alipay.euler.andfix.annotation.MethodReplace\r\n\r\nTo ensure that these classes can be found after running an obfuscation and static analysis tool like ProGuard, add the configuration below to your ProGuard configuration file.\r\n\r\n\r\n```\r\n-keep class * extends java.lang.annotation.Annotation\r\n-keepclasseswithmembernames class * {\r\n    native <methods>;\r\n}\r\n```\r\n\r\n### Self-Modifying Code\r\n\r\nIf you use it, such as *Bangcle*. To generate patch file, you'd better to use raw apk.\r\n\r\n### Security\r\n\r\nThe following is important but out of AndFix's range.\r\n\r\n-  verify the signature of patch file\r\n-  verify the fingerprint of optimize file\r\n\r\n## API Documentation\r\n\r\nThe libraries javadoc can be found [here](https://rawgit.com/alibaba/AndFix/master/docs/index.html).\r\n\r\n## Contact\r\n\r\n...\r\n\r\n## License\r\n\r\n[Apache License, Version 2.0](http://www.apache.org/licenses/LICENSE-2.0.html)\r\n\r\nCopyright (c) 2015, alipay.com\r\n",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}